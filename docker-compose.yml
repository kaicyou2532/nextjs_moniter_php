version: '3.3'

services:
  nextjs-monitor:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: nextjs-monitor-php-new
    ports:
      - "8080:80"
      - "3000:3000"
    volumes:
      - type: bind
        source: ./next-app
        target: /var/www/html/next-app
        bind:
          propagation: rshared
      - type: bind
        source: ./logs
        target: /var/www/html/logs
      - type: bind
        source: ./pids
        target: /var/www/html/pids
    environment:
      GITURL: "https://github.com/AIM-SC/next-website.git"
    restart: always
    working_dir: /var/www/html
    user: "0:0"
    privileged: true  # 権限問題を解決
